<!--
	<H3>Represents the participant in request protocol.</H3>
-->
<agent xmlns="http://jadex.sourceforge.net/jadex"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jadex.sourceforge.net/jadex
	                    http://jadex.sourceforge.net/jadex-0.96.xsd"
	name="RPReceiver"
	package="jadex.testcases.planlib">

	<imports>
		<import>jadex.planlib.*</import>
		<import>jadex.runtime.*</import>
		<import>jadex.adapter.fipa.*</import>
		<import>java.util.logging.*</import>
		<import>jadex.runtime.impl.*</import>
	</imports>

	<capabilities>
		<capability name="procap" file="jadex.planlib.Protocols"/>
	</capabilities>

	<beliefs>
		<beliefref name="rp_filter" class="IFilter">
			<concrete ref="procap.rp_filter"/>
		</beliefref>
	</beliefs>

	<goals>
		<performgoalref name="rp_receiver_interaction">
			<concrete ref="procap.rp_receiver_interaction"/>
		</performgoalref>
		<querygoalref name="rp_decide_request">
			<concrete ref="procap.rp_decide_request"/>
		</querygoalref>
		<achievegoalref name="rp_execute_request">
			<concrete ref="procap.rp_execute_request"/>
		</achievegoalref>
	</goals>

	<plans>
		<plan name="rp_decide_request_plan">
			<parameter name="action" class="Object">
				<goalmapping ref="rp_decide_request.action"/>
			</parameter>
			<parameter name="accept" class="Boolean" direction="out">
				<goalmapping ref="rp_decide_request.accept"/>
			</parameter>
			<body class="RPDecideRequestPlan"/>
			<!-- <body>new RPDecideRequestPlan()</body>-->
			<trigger>
				<goal ref="rp_decide_request"/>
			</trigger>
		</plan>

		<plan name="rp_execute_request_plan">
			<parameter name="action" class="Object">
				<goalmapping ref="rp_execute_request.action"/>
			</parameter>
			<parameter name="result" class="Object" direction="out" optional="true">
				<goalmapping ref="rp_execute_request.result"/>
			</parameter>
			<body class="RPExecuteActionPlan"/>
			<!-- <body>new RPExecuteActionPlan()</body> -->
			<trigger>
				<goal ref="rp_execute_request"/>
			</trigger>
		</plan>
		
		<plan name="negotiation_finished_plan">
			<parameter name="interaction_state" class="InteractionState">
				<!-- <goalmapping ref="da_receiver_interaction.interaction_state"/> -->
				<value>(InteractionState)((IRGoalEvent)$event).getGoal().getParameter("interaction_state").getValue()</value>
			</parameter>
			<parameter name="result" class="Object">
				<!-- <goalmapping ref="da_receiver_interaction.result"/> -->
				<value>((IRGoalEvent)$event).getGoal().getParameter("result").getValue()</value>
			</parameter>
			<body>new jadex.testcases.PrintResultPlan($plan.result)</body>
			<trigger>
				<goalfinished ref="rp_receiver_interaction"/>
			</trigger>
		</plan>
	</plans>

	<properties>
		<!--<property name="debugging">true</property>-->
		<property name="logging.level">java.util.logging.Level.FINE</property>
		<!-- <property name="logging.useParentHandlers">true</property> -->
	</properties>

	<configurations>
		<configuration name="default">
			<beliefs>
				<initialbelief ref="rp_filter">
					<fact>IFilter.ALWAYS</fact>
				</initialbelief>
			</beliefs>
		</configuration>
	</configurations>

</agent>

